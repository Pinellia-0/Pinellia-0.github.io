---
title: 计算机组成原理 第三章
tags: 笔记

---



# 第 3 章 系统总线

## 3.1 总线的基本概念

### 3.1.1 总线的基本概念

1、为什么要用总线

使用分散连接几乎无法满足人们增添或撤减设备的需求。

2、什么是总线？

总线是连接多个部件的公共信息传输线，是各个部件分时、共享的传输介质。（在任何时刻只能有一对部件使用总线）

3、总线上信息的传送

![串并行](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/a3e681c3032b057ec8eafb0875510686.png)

![](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/cbc418101a1bb92251c29d1055eacf69.png)

在某一时刻，只允许有一个部件向总线发送信息，而多个部件可以同时从总线上接收相同的信息。



4、总线结构的计算机举例

a. 面向 CPU 的双总线结构框图

![面向CPU的双总线结构](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/8e47b692d72518c834c6f77ff8e689b6.png)

特点：当I/O设备与主存交换信息时，要占用CPU，CPU运算将会停止，因此会影响CPU工作效率。



b. 单总线结构框图

![单总线结构](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/4550f26980b658bc3f3d4ac190ce03b6.png)

特点：当I/O设备与主存交换信息时，CPU可以继续处理不访问主存或者I/O设备的操作。因为只有一组总线，当CPU要读取主存中的指令，会发生冲突（总线冲突）。另外，因为只有一根总线，如果设备很多，这条系统总线会比较长，导致两个部件在进行信息交换时，延迟比较长。



c. 以存储器为中心的双总线结构框图

![以存储器为中心的双总线结构](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/5f488f3b086b541f59d5deffdba7797f.png)

特点：存储总线速度高，只提供CPU与主存之间传输信息，保留了I/O设备与存储器之间交换信息不经过CPU的特点，这样既提供了传输效率，又减轻了系统总线的负担。



## 3.2 总线的分类

### 3.2.1 片内总线

片内总线：芯片内部 的总线。如CPU内部，寄存器与寄存器之间、寄存器与算术逻辑单元ALU之间都由片内总线连接。

### 3.2.2 系统总线

- 系统总线：指计算机各部件之间 的信息传输线。按照系统总线传输信息的不同，可分为：

![](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/82554f7a4f7d793e3c29de80a4805ae3.png)

数据总线：用来传输各功能部件之间的信息。

地址总线：主要用来指出数据总线上的源数据或目标数据在主存单元的地址或I/O设备的地址。

控制总线：用来发出各种控制信号的传输线。



### 3.3.3 通信总线

- 通信总线：用于 计算机系统之间 或 计算机系统与其他系统之间的通信。

![传输方式](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/f79b802a3d4c7d4cc789084c254adc00.png)

- 串行通信总线：使用一条传输线，采用脉冲传送

  优点:只需要一条传输线，成本比较低廉。 缺点:速度慢。

- 并行传送：每一位数据需一条传输线，一般采用电位传送。

优点:短距离内，传输速度快。 缺点:成本高；距离短。



## 3.3 总线特性及性能指标

### 3.3.1 总线特性

1、机械特性：尺寸、形状、管脚数及排列顺序。

2、电气特性：传输方向和有效的电平范围。

3、功能特性：每根传输线的 功能：地址、数据、控制。

4、时间特性：信号的时序关系（何时有效）。



### 3.3.2 总线性能指标

1、总线宽度 数据线的根数，用位表示。

2、总线带宽 每秒传输的最大字节数（MBps），单位时间内总线上传输数据的位数。3. 时钟同步/异步 同步总线、异步总线。

3、总线复用 举例：地址总线与数据总线共用线路，分时复用。

4、信号总线 地址线、数据线和控制线。

5、总线控制方式 突发、自动、仲裁、计数。

6、其他指标 负载能力、电源电压、总线宽度扩展。



### 3.3.3 总线标准

总线标准：系统与各模块、模块与模块之间一个互联的标准界面。

常见的总线标准如下：

| 总线标准     | 数据线           | 总线时钟                                                     | 带宽                                                | 备注                                                         |
| :----------- | :--------------- | :----------------------------------------------------------- | :-------------------------------------------------- | :----------------------------------------------------------- |
| ISA          | 16               | 8 MHz （独立）                                               | 16 MBps                                             | 不支持总线仲裁，无法连接多台具有申请总线控制权的设备，ISA上的数据传送必须通过CPU，浪费CPU时间 |
| EISA         | 32               | 8 MHz（独立）                                                | 33 MBps                                             | 为配合32位CPU而设计的总线标准，对ISA完全兼容。               |
| VESA(VL-BUS) | 32               | 33 MHz（CPU）                                                | 133MBps                                             | 由视频电子标准协会提出的总线标准，主要针对多媒体PC要求高速传送活动图像的大量数据而生的。 |
| PCI          | 32/64            | 33 MHz（独立） 66 MHz（独立）                                | 132 MBps 528 MBps                                   | PCI：专为高度集成的外围部件、扩充插板和处理器/存储系统而设计总线标准，目前PCI标准常用于显卡、声卡、网卡等。 |
| AGP          | 32               | 66.7 MHz（独立）133 MHz（独立）                              | 266MBps 533MBps                                     | AGP：一种是视频接口标准，AGP技术主要解决了三维图像问题。     |
| RS-232       | 串行通信总线标准 | 数据终端设备（计算机）和数据通信设备（调制解调器）之间的标准接口 |                                                     | 一种串行通信总线标准，应用于串行二进制交互的数据终端设备和数据通信设备之际的标准接口。 |
| USB          | 串行接口总线标准 | 普通无屏蔽双绞线带屏蔽双绞线最高                             | 1.5 Mbps（USB1.0) 12 Mbps (USB1.0) 480 Mbps USB2.0) | 通用串行总线，用于实现外部设备的连接。                       |

其他常见的总线标准：

| 总线标准    | 描述                                   |
| :---------- | :------------------------------------- |
| IDE         | 主要用于硬盘和光驱，已逐渐淘汰         |
| SCSI        | 主要用于打印机以及服务器的硬盘接口     |
| SATA        | 串口接口，当前主流的硬盘接口           |
| PCI-Express | 最新的总线标准，将全面取代现行PCI和AGP |



## 3.4 总线结构

### 3.4.1 单总线结构

![单总线结构](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/4550f26980b658bc3f3d4ac190ce03b6.png)

优点：结构简单，成本低，易接入新设备 缺点：负载重，同一时刻只能在两个设备之间传送数据，总线数据传输的效率和速度受到限制。



### 3.4.2 多总线结构

1、双总线结构：将速度较低的I/O设备从单总线分离。

![双总线结构](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/bbf505cfd9c783731f65957cd98d1aed.png)

优点：将低速的I/O设备分离，避免CPU浪费。 缺点：需要增设通道等硬件设备。



2、三总线结构：高速外设通过DMA总线直接访问内存。

![三总线结构a](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/4f61ff4ad7cec17c6c8030d81e206354.png)

3、三总线结构的又一形式

![三总线结构b](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/aa36c42282d9e6b273d929bb8c734562.png)



4、四总线结构

![四总线结构](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/3cc6d908e928d18c91727737e59a5f97 (1).png)



### 3.4.3 总线结构举例

1、传统微型机总线结构

![传统微型机总线](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/b349c7b6f5d4d08dc0affde067811047.png)



2、VL-BUS局部总线结构

![VL-BUS局部总线](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/7190a451aed918e113389894923a3691.png)



3、PCI 总线结构

![PCI总线](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/e857078b705a4ac74636134285d1af5d.png)



4、多层PCI总线结构



## 3.5 总线控制

总线控制：统一管理总线上多个部件如何发送信息，如何接收信息，如何防止信息丢失等一系列问题。 总线控制主要包括：判优控制和通信控制

判优控制解决总线使用权问题。

通信控制解决获取使用权后，如何有效传输问题。



### 3.5.1 总线判优控制（解决总线使用权问题）

总线判优控制：当多个设备同时请求占用总线时，由总线判优控制器按其优先级别仲裁，决定由哪个主设备占用总线。

基本概念： 主设备：对总线有控制权，可向总线发送请求。 从设备：对总线没有控制权，只能响应主设备发来的总线命令。

![总线判优控制分类](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/d34b49eb814b02495833ad47210a5bb8.png)



1、链式查询

![链式查询](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/93f9dd664910d2bd04eeda2623dfd208.png)

优点：需3根控制线（BS、BR、BG各需要1根），线路少，优先级固定，易扩展。 缺点：优先级低的设备可能难获得总线使用权，对电路故障敏感。



2、计数器定时查询

![计数器定时查询](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/6fbab5f33d6fb100ce428754c3951fb7.png)

优点：设备的优先级可改变，系统故障敏感度降低 缺点：需（lgn+2）条控制线，线路复杂。其中n为设备总数。



3、独立请求查询

![独立请求查询](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/a2b45da63ff87d3aff7671128897b64e.png)

优点：设备的优先级可灵活改变，响应速度快 缺点：控制线数量多（2N），结构复杂



### 3.5.2 总线通信控制（<font color=Red>获得使用权后，如何通信</font>）

**目的：**主要解决通信双方如何获知传输开始和传输结束、以及通信双方如何协调如何配合。

总线传输周期：完成一次总线操作的时间。包括四个阶段：

1、申请分配阶段：主模块申请，总线仲裁决定

2、寻址阶段：主模块向从模块 给出地址 和 命令

3、传数阶段：主模块和从模块 交换数据

4、结束阶段：主模块 撤消有关信息

总线通信的四种方式：

1、同步通信：由统一时标控制数据的传送

2、异步通信：没有公共时钟标准，采用 应答方式

3、半同步通信：同步、异步结合

4、分离式通信：充分挖掘系统总线每个瞬间的潜力



**(1) 同步通信**

- 对应读命令

![同步式数据输入传输](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/6e0b3054527f3666212f3bc69b3b5fb9.png)

T1：主模块发地址

T2：主模块发读命令

T3：从模块提供数据

T4：主模块撤销读命令，从模块撤销数据



- 对于写命令

![同步式数据输出传输](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/35b7268f0ced95960af4dafd1f4ec884.png)

T1：主模块发地址

T1.5：主模块提供数据

T2：主模块发出命令，从模块接收到命令后，必须在规定时间内将数据总线上的数据写到地址总线所指明的单元中

T4：主模块撤销读写命令和数据等信号

**优点：**规定明确、统一，模块间配合简单一致。 缺点：主从模块的时间配合属于“强制性同步”，对于速度不同的部件而言，严重影响总线工作效率，缺乏灵活性。 适用场合：总线长度短（短距离）、各部件存取时间一致的场合。

**特点：**有定宽定距时钟，在固定的时间点上要给出固定的操作。



**(2) 异步通信（<font color=Red>无统一时钟，应答方式</font>）**

应答方式：又称握手方式，即主模块发出请求，从模块响应，然后开始通信。 应答方式分类：不互锁、半互锁和全互锁。

**1、不互锁方式**

![不互锁](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/838419bee89eb6396324b72ca15f1d4d.png)



**2、半互锁方式**

![半互锁](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/96fd77d7f4e76f2631e85525c14a6384.png)



**3、全互锁方式**

![全互锁](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/e55eb585d63cc9d78a763bbf35137bff.png)

**区别：**请求信号与回答信号的撤销时机。

​	**不互锁：**主模块与从模块之间没有依赖，请求信号与回答信号都是经过一段时间自行撤销。

​	**半互锁：**主模块发出请求信号必须确保从模块接收到，也就是说主模块必须接到从模块的回答信号，才能撤销请求信号；而从模块的回答信号不必等主模块的请求信号撤销，而是经过一段时间自动撤销回答信号。

​	**全互锁：**主模块发出请求信号必须确保从模块接收到，也就是说主模块必须接到从模块的回答信号，才能撤销请求信号；而从模块的回答信号也必须等主模块的请求信号撤销，其才能撤销。

- 特点：没有同步时钟，不需要传送同步信号，因此被传送的字符有格式要求。

- 格式：1个起始位（低电平），5-8个数据位，1个奇偶校验位，1或1.5或2个终止位（高电平）。起始位后紧跟传送字符的最低位。

- 帧：起始位和终止位构成的一帧，两帧之间的间隔可以是任意长度。

- 波特率：单位时间内传送二进制数据的位数，单位bps(位/秒)。异步通信的数据传送率用波特率来衡量。

- 比特率：单位时间内传送二进制有效数据的位数，单位依然是bps

补充：奇偶校验位

- 组成：校验位+信息位。

- 奇校验码：1的个数为奇数

- 偶校验码：1的个数为偶数

- 求法：信息位为Bn……B1

奇校验位=Bn⊕ Bn -1…… ⊕ B1 ⊕1

偶校验位= Bn⊕ Bn -1…… ⊕ B1



**(3) 半同步通信**

特点：既有公共时钟控制，又允许速度不同的工作模块协调的工作，只需插入等待周期的措施来协调通信双方的配合问题，称作半同步控制。

同步：发送方 用系统 时钟前沿 发信号；接收方 用系统 时钟后沿 判断、识别

异步：允许不同速度的模块和谐工作， 增加一条 “等待”响应信号 WAIT

![](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/df3e1f6bd973bc6abd4ebca397fb4ed7.png)

**优点：**控制方式比异步通信简单，可靠性高。 

**缺点：**对系统时钟频率不能要求太高，系统工作速度不高。

**<font color=Red>总结：</font>**针对上述三种通信的共同点

在一个总线传输周期（以输入数据为例）

- 主模块发地址 、命令 占用总线

- 从模块准备数据 不占用总线 总线空闲

- 从模块向主模块发数据 占用总线



**(4) 异步通信**

思路：充分挖掘系统总线每个瞬间的潜力。

![](https://cloud-chart-bed-1-1312894343.cos.ap-nanjing.myqcloud.com/7c64303101069731279396f9b18fd5c4.png)

特点：充分提高了总线的有效占用。

1、各模块有权申请占用总线；

获得使用权后，采用同步方式通信，不等对方回答；

2、各模块准备数据时，不占用总线；

3、总线被占用时，无空闲。



## 3.6 习题

1、总线分类

按连接部件不同，总线通常可以分为 片内总线、系统总线、通信总线。 按传输内容的不同，可分为 数据总线、地址总线、控制总线。 按数据传输方式的不同，总线可分为串行 传输总线 和 并行传输总线

2、总线的传输周期

① 申请分配阶段 ② 寻址阶段 ③ 传数阶段 ④ 结束阶段

3、总线上的主模块是指 对总线有控制权的模块，从模块是指被主模块访问的模块，只能响应总模块发来的各种总线命令。

4、总线判优控制解决 总线使用权问题。可分为集中式和分布式两种。 集中式包括链式查询方式、计数器定时查询方式、独立请求方式

5、总线通信控制解决 获得使用权后，通信双方如何通信（如何获取传输开始和传输结束，以及通信双方如何协调、如何配合） 在同步通信中，设备之间没有应答信号，数据传输在 公共时钟信号数据控制 下进行。一般用于总线长度较短，总线上各部件存取时间比较一致场合。 在异步通信中，没有固定的总线传输周期（统一时钟），通信双方通过 应答信号 联络。一般用于总线上各部件速度不一致的。 在半同步通信中，既有统一的时钟信号，又允许不同速度的模块和谐工作。为此需增加一条 “等待”(WAIT)响应 **信号线。 在分离式通信中，充分对总线进行了有效占用，总线上所有模块都是主**模块。

6、总线宽度是指 数据总线的根数；总线带宽是指 单位时间内总线上传输数据的位数。

7、三总线结构包括：I/O总线（连接CPU与I/O设备），主存总线（连接CPU与主存），DMA总线（连接主存与I/O设备）